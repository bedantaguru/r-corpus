<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>JSON Data Input — read_ndjson • corpus</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">corpus</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/corpus.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/chinese.html">Chinese text handling</a>
    </li>
    <li>
      <a href="../articles/gender.html">Finding gendered words</a>
    </li>
    <li>
      <a href="../articles/textdata.html">Text data in Corpus and other packages</a>
    </li>
    <li>
      <a href="../articles/unicode.html">Unicode: Emoji, accents, and international text</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>JSON Data Input</h1>
    </div>

    
    <p>Read data from a file in newline-delimited JavaScript Object Notation
    (NDJSON) format.</p>
    

    <pre class="usage"><span class='fu'>read_ndjson</span>(<span class='no'>file</span>, <span class='kw'>mmap</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>simplify</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>text</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>file</th>
      <td><p>the name of the file which the data are to be read from,
        or a connection (unless <code>mmap</code> is <code>TRUE</code>, see below).
        The data should be encoded as UTF-8, and each line should be a
        valid JSON value.</p></td>
    </tr>
    <tr>
      <th>mmap</th>
      <td><p>whether to memory-map the file instead of reading all
        of its data into memory simultaneously. See the
        &#8216;Memory mapping&#8217; section.</p></td>
    </tr>
    <tr>
      <th>simplify</th>
      <td><p>whether to attempt to simplify the type of the return
       value. For example, if each line of the file stores an integer,
       if <code>simplify</code> is set to <code>TRUE</code> then the return value
       will be an integer vector rather than a <code>corpus_json</code> object.</p></td>
    </tr>
    <tr>
      <th>text</th>
      <td><p>a character vector of string fields to interpret as
       <code>text</code> instead of <code>character</code>, or <code>NULL</code> to
       interpret all strings as <code>character</code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function is the recommended means of reading data for processing
    by the corpus package.</p>
<p>When the <code>text</code> argument is non-<code>NULL</code> string data
    fields with names indicated by this argument are decoded as
    <code>text</code> values, not as <code>character</code> values.</p>
    
    <h2 class="hasAnchor" id="memory-mapping"><a class="anchor" href="#memory-mapping"></a>Memory mapping</h2>

    <p>When you specify <code>mmap = TRUE</code>, the function memory-maps the file
    instead of reading it into memory directly. In this case, the <code>file</code>
    argument must be a character string giving the path to the file, not
    a connection object. When you memory-map the file, the operating
    system reads data into memory only when it is needed, enabling
    you to transparently process large data sets that do not fit into
    memory.</p>
<p>In terms of memory usage, enabling <code>mmap = TRUE</code> reduces the
    footprint for <code>corpus_json</code> and <code>corpus_text</code> objects;
    native R objects (<code>character</code>, <code>integer</code>, <code>list</code>,
    <code>logical</code>, and <code>numeric</code>) get fully deserialized to
    memory and produce identical results regardless of whether
    <code>mmap</code> is <code>TRUE</code> or <code>FALSE</code>. To process a large
    text corpus with a text field named <code>"text"</code>, you should set
    <code>text = "text"</code> and <code>mmap = TRUE</code>. Or, to reduce the memory
    footprint even further, set <code>simplify = FALSE</code> and
    <code>mmap = TRUE</code>.</p>
<p>One danger in memory-mapping is that if you delete the file
    after calling <code>read_ndjson</code> but before processing the data, then
    the results will be undefined, and your computer may crash. (On
    POSIX-compliant systems like Mac OS and Linux, there should be no
    ill effects to deleting the file. On recent versions of Windows,
    the system will not allow you to delete the file as long as the data
    is active.)</p>
<p>Another danger in memory-mapping is that if you serialize a
    <code>corpus_json</code> object or derived <code>corpus_text</code> object using
    <code>saveRDS</code> or another similar function, and then you
    deserialize the object, R will attempt create a new memory-map
    using the <code>file</code> argument passed to the original <code>read_ndjson</code>
    call. If <code>file</code> is a relative path, then your working directory
    at the time of deserialization must agree with your working directory
    at the time of the <code>read_ndjson</code> call.  You can avoid this
    situation by specifying an absolute path as the <code>file</code> argument
    (the <code>normalizePath</code> function will convert a relative
    to an absolute path).</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>In the default usage, with argument <code>simplify = TRUE</code>, when
    the lines of the file are records (JSON object literals), the
    return value from <code>read_ndjson</code> is a data frame with class
    <code>c("corpus_frame", "data.frame")</code>. With <code>simplify = FALSE</code>,
    the result is a <code>corpus_json</code> object.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='as_text.html'>as_text</a></code>, <code><a href='utf8.html'>as_utf8</a></code>.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Memory mapping</span>
<span class='no'>lines</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='st'>'{ "a": 1, "b": true }'</span>,
           <span class='st'>'{ "b": false, "nested": { "c": 100, "d": false }}'</span>,
           <span class='st'>'{ "a": 3.14, "nested": { "d": true }}'</span>)
<span class='no'>file</span> <span class='kw'>&lt;-</span> <span class='fu'>tempfile</span>()
<span class='fu'>writeLines</span>(<span class='no'>lines</span>, <span class='no'>file</span>)
(<span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'>read_ndjson</span>(<span class='no'>file</span>, <span class='kw'>mmap</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>))</div><div class='output co'>#&gt;      a     b nested.c nested.d
#&gt; 1 1.00  TRUE       NA       NA
#&gt; 2   NA FALSE      100    FALSE
#&gt; 3 3.14    NA       NA     TRUE</div><div class='input'>
<span class='no'>data</span>$<span class='no'>a</span></div><div class='output co'>#&gt; [1] 1.00   NA 3.14</div><div class='input'><span class='no'>data</span>$<span class='no'>b</span></div><div class='output co'>#&gt; [1]  TRUE FALSE    NA</div><div class='input'><span class='no'>data</span>$<span class='no'>nested.c</span></div><div class='output co'>#&gt; [1]  NA 100  NA</div><div class='input'><span class='no'>data</span>$<span class='no'>nested.d</span></div><div class='output co'>#&gt; [1]    NA FALSE  TRUE</div><div class='input'>
<span class='fu'>rm</span>(<span class='st'>"data"</span>)
<span class='fu'>invisible</span>(<span class='fu'>gc</span>()) <span class='co'># force the garbage collector to release the memory-map</span>
<span class='fu'>file.remove</span>(<span class='no'>file</span>)</div><div class='output co'>#&gt; [1] TRUE</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#memory-mapping">Memory mapping</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Patrick O. Perry.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
